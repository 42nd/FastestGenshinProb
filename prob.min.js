/*FastestGenshinProb v1.1 by 42nd*/function singleProb(e,t=[]){if(void 0!==t[e])return t[e];let $;return $=e<=72?.006:e>=89?1:.006+.06*(e-72),t[e]=$,$}function exactlyC(e,t,$,n,_=!1){if(n<1||n>7)throw Error("target_C must be between 1 and 7.");let l={};function i(e,t,$){return 100n*BigInt(e)+10n*BigInt(t)+BigInt($)}let o=new Map,r=i(e,t?1:0,0n);o.set(r,1);let f=[];for(let s=0;s<$;s++){let u=new Map,g=0;for(let[c,b]of o){if(b<1e-12)continue;let m=Number(c/100n),a=Number(c/10n%10n),w=Number(c%10n);if(w>n)continue;let P=singleProb(m,l),h=1-P,p=Math.min(m+1,89),C=i(p,a,w),d=b*h;u.set(C,(u.get(C)||0)+d),w===n&&(g+=d);let v,y;if(0===a){let L=i(0,1,w),x=b*P*.5;u.set(L,(u.get(L)||0)+x),w===n&&(g+=x),y=i(0,0,v=Math.min(w+1,n+1));let j=b*P*.5;u.set(y,(u.get(y)||0)+j),v===n&&(g+=j)}else{y=i(0,0,v=Math.min(w+1,n+1));let k=b*P;u.set(y,(u.get(y)||0)+k),v===n&&(g+=k)}}o=u,_&&f.push(100*g)}if(_)return f;{let q=0;for(let[z,A]of o){let B=Number(z%10n);B===n&&(q+=A)}return 100*q}}function P_constell_probabilities(e,t,$,n,_){let l={};function i(e,t,$){return 100n*BigInt(e)+10n*BigInt(t)+BigInt($)}let o=new Map,r=i(e,t?1:0,0n);o.set(r,1);let f=_-n,s=Array(f+1).fill(0);for(let u=0;u<$;u++){let g=new Map;for(let[c,b]of o){if(b<1e-12)continue;let m=Number(c/100n),a=Number(c/10n%10n),w=Number(c%10n);if(w>f)continue;let P=singleProb(m,l),h=1-P,p=Math.min(m+1,89),C=i(p,a,w),d=b*h;if(g.set(C,(g.get(C)||0)+d),u===$-1&&w>=1&&w<=f&&(s[w]+=d),P>0){if(0===a){let v=i(0,1,w),y=b*P*.5;g.set(v,(g.get(v)||0)+y),u===$-1&&w>=1&&w<=f&&(s[w]+=y);let L=Math.min(w+1,f),x=i(0,0,L),j=b*P*.5;g.set(x,(g.get(x)||0)+j),u===$-1&&L>=1&&L<=f&&(s[L]+=j)}else{let k=Math.min(w+1,f),q=i(0,0,k),z=b*P;g.set(q,(g.get(q)||0)+z),u===$-1&&k>=1&&k<=f&&(s[k]+=z)}}}o=g}for(let A=1;A<=f;A++)s[A]*=100;let B=[];for(let D=1;D<=f;D++){let E=n+D;B.push({constellationLevel:E,probability:s[D]})}return B}function atLeastC(e,t,$,n){if(n<1||n>7)throw Error("target_C must be between 1 and 7.");let _={};function l(e,t,$){return 100n*BigInt(e)+10n*BigInt(t)+BigInt($)}let i=new Map,o=l(e,t?1:0,0n);i.set(o,1);let r=Math.min(Math.floor($/10),7);for(let f=0;f<$;f++){let s=new Map;for(let[u,g]of i){let c=Number(u/100n),b=Number(u/10n%10n),m=Number(u%10n);if(m>r)continue;let a=singleProb(c,_),w=1-a,P=Math.min(c+1,89),h=l(P,b,m);s.set(h,(s.get(h)||0)+g*w);let p,C;if(0===b){let d=l(0,1,m);s.set(d,(s.get(d)||0)+g*a*.5),C=l(0,0,p=Math.min(m+1,r)),s.set(C,(s.get(C)||0)+g*a*.5)}else C=l(0,0,p=Math.min(m+1,r)),s.set(C,(s.get(C)||0)+g*a)}i=s}let v=0;for(let[y,L]of i){let x=Number(y%10n);x>=n&&(v+=L)}return 100*v}
